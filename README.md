# Android Background Services Playground

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –ø–ª–æ—â–∞–¥–∫—É (playground) –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–ø–æ—Å–æ–±–æ–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –≤ Android. –û–Ω –Ω–∞–≥–ª—è–¥–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `Foreground Service` –∏ `Bound Service`, –∞ —Ç–∞–∫–∂–µ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `DownloadManager` –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø—Ä–∞–∫—Ç–∏–∫, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (Runtime Permissions) –∏ –∫–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (Notification Channels).

## üöÄ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

1.  **Foreground Service (`MyForegroundService`)**:
    *   –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–∞–∫ —Å–µ—Ä–≤–∏—Å –ø–µ—Ä–µ–¥–Ω–µ–≥–æ –ø–ª–∞–Ω–∞, –ø–æ–∫–∞–∑—ã–≤–∞—è **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.
    *   –ò–º–∏—Ç–∏—Ä—É–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –≤ —Ñ–æ–Ω–µ —Å –ø–æ–º–æ—â—å—é –∫–æ—Ä—É—Ç–∏–Ω (–±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ç–∞–π–º–µ—Ä).
    *   –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è `Foreground Service` –∏ –∏–Ω—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É.

2.  **Bound Service (`MyBoundService`)**:
    *   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ –≥–∏–±—Ä–∏–¥–Ω—ã–π —Å–µ—Ä–≤–∏—Å: –µ–≥–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —á–µ—Ä–µ–∑ `startService` –∏ –ø—Ä–∏–≤—è–∑–∞—Ç—å—Å—è –∫ –Ω–µ–º—É —á–µ—Ä–µ–∑ `bindService`.
    *   –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **–≤—Ä–µ–º–µ–Ω–Ω—ã–µ (–æ–±—ã—á–Ω—ã–µ)** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.
    *   –¢–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–∞–π–º–µ—Ä –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —Ñ–æ–Ω–æ–≤–æ–π —Ä–∞–±–æ—Ç—ã.
    *   –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `Binder` –¥–ª—è `Activity`, —á—Ç–æ–±—ã –≤ –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä—è–º–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞).

3.  **DownloadManager**:
    *   –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π —Å–µ—Ä–≤–∏—Å `DownloadManager` –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ.

4.  **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UI –Ω–∞ Jetpack Compose**:
    *   –í–µ—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—Å—Ç—Ä–æ–µ–Ω —Å –ø–æ–º–æ—â—å—é Jetpack Compose.
    *   –ö–Ω–æ–ø–∫–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Å–µ—Ä–≤–∏—Å–∞.

5.  **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π Android 13+**:
    *   –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è `POST_NOTIFICATIONS`, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –Ω–∞ Android 13 (API 33) –∏ –≤—ã—à–µ.

## üõ†Ô∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã

-   **`MainActivity.kt`**:
    *   –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
    *   –°–æ–¥–µ—Ä–∂–∏—Ç UI –Ω–∞ Jetpack Compose.
    *   –†–µ–∞–ª–∏–∑—É–µ—Ç –ª–æ–≥–∏–∫—É –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (`requestPermissionLauncher`).
    *   –°–æ–¥–µ—Ä–∂–∏—Ç —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã `startService()` –∏ `stopService()` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞–º–∏.

-   **`MyForegroundService.kt`**:
    *   –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –ø–µ—Ä–µ–¥–Ω–µ–≥–æ –ø–ª–∞–Ω–∞.
    *   –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã: `onStartCommand()`, `startForeground()`.

-   **`MyBoundService.kt`**:
    *   –†–µ–∞–ª–∏–∑–∞—Ü–∏—è "–ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ" (–∏ "–∑–∞–ø—É—â–µ–Ω–Ω–æ–≥–æ") —Å–µ—Ä–≤–∏—Å–∞.
    *   –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã: `onStartCommand()`, `onBind()`, `onDestroy()`.
    *   –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–∫–∞–∑ –æ–±—ã—á–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∏–∑ —Å–µ—Ä–≤–∏—Å–∞.

-   **`App.kt`**:
    *   –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–ª–∞—Å—Å `Application`.
    *   **–í–∞–∂–Ω–µ–π—à–∞—è —Ä–æ–ª—å**: —Å–æ–∑–¥–∞–µ—Ç –∫–∞–Ω–∞–ª—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (`NotificationChannel`) –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–ª—è Android 8.0 (API 26) –∏ –≤—ã—à–µ.

-   **`Constants.kt`**:
    *   –•—Ä–∞–Ω–∏—Ç –≤—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ (ID –∫–∞–Ω–∞–ª–æ–≤, —Ç–µ–≥–∏ –¥–ª—è –ª–æ–≥–æ–≤, —Ç–µ–∫—Å—Ç—ã).
    *   –°–æ–¥–µ—Ä–∂–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—É—é **—Ñ—É–Ω–∫—Ü–∏—é-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** `Context.showNotification()`, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª—é–±–æ–º—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ `Context` (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–≤–∏—Å—É) –ª–µ–≥–∫–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

-   **`AndroidManifest.xml`**:
    *   "–ü–∞—Å–ø–æ—Ä—Ç" –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    *   –û–±—ä—è–≤–ª—è–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (`POST_NOTIFICATIONS`, `FOREGROUND_SERVICE`, `INTERNET` –∏ —Ç.–¥.).
    *   –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –æ–±–∞ —Å–µ—Ä–≤–∏—Å–∞ (`MyForegroundService`, `MyBoundService`) –∏ –∫–ª–∞—Å—Å `App`.

## ‚öôÔ∏è –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1.  –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
2.  –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ Android Studio.
3.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —ç–º—É–ª—è—Ç–æ—Ä–µ –∏–ª–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.
4.  **–î–ª—è `Foreground Service`**:
    *   –ù–∞–∂–º–∏—Ç–µ **"Start Foreground Service"**. –ï—Å–ª–∏ —É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –µ—â–µ –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, –ø–æ—è–≤–∏—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥ —Å –∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.
    *   –ü–æ—Å–ª–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–π —à—Ç–æ—Ä–∫–µ.
    *   –ù–∞–∂–º–∏—Ç–µ **"Stop Foreground Service"**, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å –∏ —É–±—Ä–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ.
5.  **–î–ª—è `Bound Service`**:
    *   –ù–∞–∂–º–∏—Ç–µ **"Start Bound Service"**. –ü–æ—è–≤–∏—Ç—Å—è **–≤—Ä–µ–º–µ–Ω–Ω–æ–µ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–ø—É—Å–∫–µ —Å–µ—Ä–≤–∏—Å–∞.
    *   –ù–∞–∂–º–∏—Ç–µ **"Stop Bound Service"**. –ü–æ—è–≤–∏—Ç—Å—è **–≤—Ä–µ–º–µ–Ω–Ω–æ–µ** —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—Å—Ç–∞–Ω–æ–≤–∫–µ.

## üéì –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ

-   **–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–µ—Ä–≤–∏—Å–æ–≤**: –†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É `onCreate()`, `onStartCommand()`, `onBind()` –∏ `onDestroy()`.
-   **Foreground vs. Background**: –ü–æ—á–µ–º—É –¥–ª—è –¥–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á, –≤–∏–¥–∏–º—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –Ω—É–∂–µ–Ω `Foreground Service` —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º.
-   **Notification Channels**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø–æ –∫–∞–Ω–∞–ª–∞–º –¥–ª—è Android 8.0+.
-   **Runtime Permissions**: –ö–∞–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å "–æ–ø–∞—Å–Ω—ã–µ" —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ `POST_NOTIFICATIONS`) —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
-   **–ö–æ—Ä—É—Ç–∏–Ω—ã Kotlin**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `CoroutineScope` –∏ `Job` –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–æ–≤.
-   **–§—É–Ω–∫—Ü–∏–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (Extension Functions)**: –°–æ–∑–¥–∞–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ `Context.showNotification()`.
